# Лабораторная работа №3

### Вариант 312442

По варианту, выданному преподавателем, составить и выполнить запросы к базе данных "Учебный процесс".

Команда для подключения к базе данных ucheb:

psql -h pg -d ucheb

Составить запросы на языке SQL (пункты 1-7).

1. Сделать запрос для получения атрибутов из указанных таблиц, применив фильтры по указанным условиям:
Н_ТИПЫ_ВЕДОМОСТЕЙ, Н_ВЕДОМОСТИ.
Вывести атрибуты: Н_ТИПЫ_ВЕДОМОСТЕЙ.ИД, Н_ВЕДОМОСТИ.ЧЛВК_ИД.
Фильтры (AND):
   
   a) Н_ТИПЫ_ВЕДОМОСТЕЙ.ИД < 1.

   b) Н_ВЕДОМОСТИ.ЧЛВК_ИД = 163249.
   
   Вид соединения: INNER JOIN.
2. Сделать запрос для получения атрибутов из указанных таблиц, применив фильтры по указанным условиям:
Таблицы: Н_ЛЮДИ, Н_ВЕДОМОСТИ, Н_СЕССИЯ.
Вывести атрибуты: Н_ЛЮДИ.ИМЯ, Н_ВЕДОМОСТИ.ДАТА, Н_СЕССИЯ.УЧГОД.
Фильтры (AND):

   a) Н_ЛЮДИ.ФАМИЛИЯ > Ёлкин.

   b) Н_ВЕДОМОСТИ.ДАТА < 2010-06-18.

   c) Н_СЕССИЯ.ИД > 14.
Вид соединения: INNER JOIN.
3. Вывести число имен без учета повторений.
При составлении запроса нельзя использовать DISTINCT.
4. Выдать различные имена людей и число людей с каждой из этих имен, ограничив список именами, встречающимися более 50 раз на ФКТИУ. Для реализации использовать соединение таблиц.
5. Выведите таблицу со средним возрастом студентов во всех группах (Группа, Средний возраст), где средний возраст меньше максимального возраста в группе 1101.
6. Получить список студентов, зачисленных после первого сентября 2012 года на первый курс очной или заочной формы обучения (специальность: Программная инженерия). В результат включить:
номер группы;
номер, фамилию, имя и отчество студента;
номер и состояние пункта приказа;
Для реализации использовать подзапрос с IN.
7. Сформировать запрос для получения числа в СПбГУ ИТМО отличников.